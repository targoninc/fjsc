function x(s){return new B(s)}function j(s){return new I(s)}function U(){return x("div").styles("display","none").build()}function L(s,t,r=!1){if(s&&s.constructor===I){let o=j(s.value?r?U():t:r?t:U());return s.subscribe((f)=>{if(f)o.value=r?U():t;else o.value=r?t:U()}),o}else return s?r?U():t:r?t:U()}function K(s,t,r,o=!1){if(s.constructor!==I)throw new Error("Invalid argument type for signalMap. Must be a Signal.");let f=(p)=>{if(!p)return;let C=[];for(let O=0;O<p.length;O++)C.push(r(p[O],O));t.overwriteChildren(...C)};return s.subscribe(f),f(s.value),t.build()}function T(s,t){let r=j(t(s.value));return s.subscribe((o)=>{try{r.value=t(o)}catch(f){r.value=null}}),r}function D(s,t={}){console.warn(s,{debugInfo:t},new Error().stack)}class Q{static assertString(s,t="value"){let r=s.constructor===String;if(!r)console.log("TypeHelper.isString: value is not a string for "+t+": ",s);return r}static assertFunction(s,t="value"){let r=s.constructor===Function;if(!r)console.log("TypeHelper.isFunction: value is not a function for "+t+": ",s);return r}}class _{static keyName="__fjs_store__";static get(s){return window[this.keyName][s]}static set(s,t){window[this.keyName][s]=t}static clear(){window[this.keyName]={}}static remove(s){delete window[this.keyName][s]}static getAll(){return window[this.keyName]}static keys(){return Object.keys(window[this.keyName])}static values(){return Object.values(window[this.keyName])}static getSignalValue(s){return this.get(s).value}static setSignalValue(s,t){this.get(s).value=t}}function W(s=null,t=null){if(!window[_.keyName])window[_.keyName]={};if(arguments.length===1)return _.get(arguments[0]);else if(arguments.length===2)return _.set(arguments[0],arguments[1]);throw new Error("Passing more than 2 arguments to store() is not supported.")}class I{_callbacks=[];_value;_values={};constructor(s,t=()=>{},r=null){if(this._value=s,this._values={},this._callbacks.push(t),r)W().set(r,this)}boolValues(s={}){for(let t in s)this._values[t]=j(this._value?s[t].onTrue:s[t].onFalse);return this.subscribe((t)=>{for(let r in s)this._values[r].value=t?s[r].onTrue:s[r].onFalse}),this._values}unsubscribeAll(){this._callbacks=[]}subscribe(s){this._callbacks.push(s)}unsubscribe(s){let t=this._callbacks.indexOf(s);if(t>=0)this._callbacks.splice(t,1)}get onUpdate(){return this._callbacks}set onUpdate(s){this._callbacks.push(s)}get value(){return this._value}set value(s){let t=this._value!==s;this._value=s,this._callbacks.forEach((r)=>r(s,t))}}function h(s){return[HTMLElement,SVGElement].some((r)=>s instanceof r)}class B{_node;svgTags=["svg","g","circle","ellipse","line","path","polygon","polyline","rect","text","textPath","tspan"];constructor(s){if(this.svgTags.includes(s))this._node=document.createElementNS("http://www.w3.org/2000/svg",s);else this._node=document.createElement(s)}build(){if(!h(this._node))throw new Error("Invalid node type. Must be an HTMLElement or a subclass.");return this._node}wrapProperty(s,t){if(t&&t.constructor===I)this._node[s]=t.value,t.onUpdate=(r)=>{this._node[s]=r};else this._node[s]=t}class(s){return this.classes(s)}classes(...s){for(let t of s)if(t&&t.constructor===I){let r=t.value;this._node.classList.add(r),t.onUpdate=(o)=>{this._node.classList.remove(r),this._node.classList.add(o),r=o}}else this._node.classList.add(t);return this}attribute(s,t){return this.attributes(s,t)}attributes(...s){if(arguments.length%2===0)for(let t=0;t<arguments.length;t+=2){let r=arguments[t],o=arguments[t+1];if(Q.assertString(r,"attributes/key"),o&&o.constructor===I)this._node.setAttribute(r,o.value),o.onUpdate=(f)=>{this._node.setAttribute(r,f)};else this._node.setAttribute(r,o)}else throw new Error("Invalid number of arguments for attributes. Must be even. (key, value, key, value, ...)");return this}id(s){return this.wrapProperty("id",s),this}text(s){return this.wrapProperty("innerText",s),this}title(s){return this.wrapProperty("title",s),this}html(s){return this.wrapProperty("innerHTML",s),this}children(...s){for(let t of arguments)if(h(t))this._node.appendChild(t);else if(t instanceof B)this._node.appendChild(t.build());else if(t&&t.constructor===I){let r=t.value;if(!h(r))r=U();this._node.appendChild(r),t.onUpdate=(o)=>{if(h(o))this._node.replaceChild(o,r),r=o;else if(o.constructor===B)this._node.replaceChild(o.build(),r),r=o.build();else D("Unexpected value for child. Must be an HTMLElement or a subclass.",o)}}else if(t&&t.constructor===Array)for(let r of t)this.children(r);else if(t)D("Invalid node type. Must be an HTMLElement or a subclass.",t);return this}overwriteChildren(){return this._node.innerHTML="",this.children(...arguments)}child(){return this.children(...arguments)}role(s){return this.wrapProperty("role",s),this}prefixedAttribute(s,t,r){return this.attributes(`${s}-${t}`,r)}aria(s,t){return this.prefixedAttribute("aria",s,t)}data(s,t){return this.prefixedAttribute("data",s,t)}onclick(s){return this._node.onclick=s,this}onauxclick(s){return this._node.onauxclick=s,this}ondblclick(s){return this._node.ondblclick=s,this}onchange(s){return this._node.onchange=s,this}oninput(s){return this._node.oninput=s,this}onkeydown(s){return this._node.onkeydown=s,this}onkeyup(s){return this._node.onkeyup=s,this}onmousedown(s){return this._node.onmousedown=s,this}onmouseup(s){return this._node.onmouseup=s,this}onmouseover(s){return this._node.onmouseover=s,this}onmouseout(s){return this._node.onmouseout=s,this}onmousemove(s){return this._node.onmousemove=s,this}onmouseenter(s){return this._node.onmouseenter=s,this}onmouseleave(s){return this._node.onmouseleave=s,this}oncontextmenu(s){return this._node.oncontextmenu=s,this}onwheel(s){return this._node.onwheel=s,this}ondrag(s){return this._node.ondrag=s,this}ondragend(s){return this._node.ondragend=s,this}ondragenter(s){return this._node.ondragenter=s,this}ondragstart(s){return this._node.ondragstart=s,this}ondragleave(s){return this._node.ondragleave=s,this}ondragover(s){return this._node.ondragover=s,this}ondrop(s){return this._node.ondrop=s,this}onscroll(s){return this._node.onscroll=s,this}onfocus(s){return this._node.onfocus=s,this}onblur(s){return this._node.onblur=s,this}onresize(s){return this._node.onresize=s,this}onselect(s){return this._node.onselect=s,this}onsubmit(s){return this._node.onsubmit=s,this}onreset(s){return this._node.onreset=s,this}onabort(s){return this._node.onabort=s,this}onerror(s){return this._node.onerror=s,this}oncanplay(s){return this._node.oncanplay=s,this}oncanplaythrough(s){return this._node.oncanplaythrough=s,this}ondurationchange(s){return this._node.ondurationchange=s,this}onemptied(s){return this._node.onemptied=s,this}onended(s){return this._node.onended=s,this}onloadeddata(s){return this._node.onloadeddata=s,this}onloadedmetadata(s){return this._node.onloadedmetadata=s,this}onloadstart(s){return this._node.onloadstart=s,this}onpause(s){return this._node.onpause=s,this}onplay(s){return this._node.onplay=s,this}onplaying(s){return this._node.onplaying=s,this}onprogress(s){return this._node.onprogress=s,this}onratechange(s){return this._node.onratechange=s,this}onseeked(s){return this._node.onseeked=s,this}onseeking(s){return this._node.onseeking=s,this}onstalled(s){return this._node.onstalled=s,this}onsuspend(s){return this._node.onsuspend=s,this}ontimeupdate(s){return this._node.ontimeupdate=s,this}onvolumechange(s){return this._node.onvolumechange=s,this}onwaiting(s){return this._node.onwaiting=s,this}oncopy(s){return this._node.oncopy=s,this}oncut(s){return this._node.oncut=s,this}onpaste(s){return this._node.onpaste=s,this}onanimationstart(s){return this._node.onanimationstart=s,this}onanimationend(s){return this._node.onanimationend=s,this}onanimationiteration(s){return this._node.onanimationiteration=s,this}ontransitionend(s){return this._node.ontransitionend=s,this}on(s,t){return this._node.addEventListener(s,t),this}open(s){return this.wrapProperty("open",s),this}src(s){return this.wrapProperty("src",s),this}alt(s){return this.wrapProperty("alt",s),this}css(s){return this._node.style.cssText=s,this}style(s,t){return this.styles(s,t)}styles(...s){if(arguments.length%2===0)for(let t=0;t<arguments.length;t+=2){let r=arguments[t],o=arguments[t+1];if(r.constructor!==String)throw new Error("Invalid key type for styles. Must be a string.");if(o&&o.constructor===I)this._node.style[r]=o.value,o.onUpdate=(f)=>{this._node.style[r]=f};else this._node.style[r]=o}else throw new Error("Invalid number of arguments for styles. Must be even. (key, value, key, value, ...)");return this}width(s){return this.wrapProperty("width",s),this}height(s){return this.wrapProperty("height",s),this}type(s){return this.wrapProperty("type",s),this}name(s){return this.wrapProperty("name",s),this}value(s){return this.wrapProperty("value",s),this}placeholder(s){return this.wrapProperty("placeholder",s),this}for(s){return this.wrapProperty("for",s),this}checked(s){return this.wrapProperty("checked",s),this}disabled(s){return this.wrapProperty("disabled",s),this}selected(s){return this.wrapProperty("selected",s),this}href(s){return this.wrapProperty("href",s),this}target(s){return this.wrapProperty("target",s),this}rel(s){return this.wrapProperty("rel",s),this}required(s){return this.wrapProperty("required",s),this}multiple(s){return this.wrapProperty("multiple",s),this}accept(s){return this.wrapProperty("accept",s),this}acceptCharset(s){return this.wrapProperty("acceptCharset",s),this}action(s){return this.wrapProperty("action",s),this}autocomplete(s){return this.wrapProperty("autocomplete",s),this}enctype(s){return this.wrapProperty("enctype",s),this}method(s){return this.wrapProperty("method",s),this}novalidate(s){return this.wrapProperty("novalidate",s),this}}class P{static button(s){return s.classes??=[],x("button").classes("fjsc",...s.classes).text(s.text).onclick(s.onclick).build()}static input(s){return x("input").classes("fjsc").type(s.type).value(s.value).accept(s.accept).placeholder(s.placeholder).onchange((t)=>{if(s.onchange)s.onchange(t.target.value)}).name(s.name).build()}static area(s){return s.classes??=[],s.children??=[],x(s.tag??"div").classes("fjsc","fjsc-area",...s.classes).children(...s.children).build()}static container(s){return s.classes??=[],s.children??=[],x(s.tag??"div").classes("fjsc","fjsc-container",...s.classes).children(...s.children).build()}static text(s){return x(s.tag??"span").classes("fjsc").text(s.text).build()}static icon(s){let t=s.icon,r=!s.isUrl,o=s.adaptive?"adaptive-icon":"static-icon";if(r)return x("i").classes(o,"fjsc","material-symbols-outlined","no-pointer").text(t).build();return x("img").classes(o,"fjsc","no-pointer").attributes("src",t).build()}static searchableSelect(s){let t=s.options??j([]),r=s.value??j(null),o=j(t.value.find((i)=>i.id===r.value)?.name??""),f=j(!1),p=j(t.value),C=j(0),O=()=>{p.value=t.value.filter((i)=>i.name.toLowerCase().includes(o.value.toLowerCase()))};t.subscribe(O),o.subscribe(O),O();let G=j(t.value[0].id),A=()=>{G.value=p.value[C.value]?.id};C.subscribe(A),p.subscribe(A),A();let R=T(f,(i)=>i?"arrow_drop_up":"arrow_drop_down");return x("div").classes("fjsc-search-select","flex-v","relative").children(x("div").classes("flex","fjsc-search-select-visible").children(x("input").classes("fjsc","fjsc-search-select-input").value(o).onfocus(()=>{f.value=!0}).onkeydown((i)=>{switch(i.key){case"Enter":i.preventDefault(),i.stopPropagation();let z=p.value[C.value];r.value=z?.id??r.value,o.value=z?.name??o.value,f.value=!1;break;case"ArrowDown":i.preventDefault(),i.stopPropagation(),C.value=(C.value+1)%p.value.length;break;case"ArrowUp":i.preventDefault(),i.stopPropagation(),C.value=(C.value-1+p.value.length)%p.value.length;break;case"Escape":case"Tab":f.value=!1;break;default:if(i.keyCode>32&&i.keyCode<126||i.key==="Backspace")setTimeout(()=>{o.value=i.target.value,C.value=0});break}}).build(),x("div").classes("fjsc-search-select-dropdown").onclick(()=>{f.value=!f.value}).children(P.icon({icon:R,isUrl:!1,adaptive:!0})).build()).build(),L(f,K(p,x("div").classes("fjsc-search-select-options","flex-v"),(i)=>P.searchSelectOption({option:i,value:r,search:o,optionsVisible:f,selectedId:G})))).build()}static searchSelectOption(s){let t,r=T(s.selectedId,(o)=>{return t?.scrollIntoView({behavior:"smooth",block:"nearest"}),o===s.option.id?"selected":"_"});return t=x("div").classes("fjsc-search-select-option","flex","gap","padded",r).onclick(()=>{s.value.value=s.option.id,s.search.value=s.option.name,s.optionsVisible.value=!1}).children(L(s.option.image,P.icon({icon:s.option.image,isUrl:s.option.imageIsUrl,adaptive:!0})),x("span").text(s.option.name).build()).build(),t}}export{P as FJSC};

//# debugId=192B7A282216801264756E2164756E21
//# sourceMappingURL=FJSC.js.map
